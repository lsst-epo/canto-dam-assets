{% import "_includes/forms" as forms %}

{% set tagOptions = {
    'depends': [
        'lsst\\cantodamassets\\web\\assets\\CantoDamAsset'
    ],
} %}
{{ craft.canto.register('src/js/app.ts', false, tagOptions, tagOptions) }}
{{ craft.canto.register('src/js/canto-field.js', false, tagOptions, tagOptions) }}

{% set cantoFieldId = id ?? field.getInputId() %}

{{ forms.hidden({
    id: "cantoId" | namespaceInputId(cantoFieldId),
    name: "cantoId" | namespaceInputName(name),
    value: value.cantoId,
}) }}

{{ forms.hidden({
    id: "cantoAlbumId" | namespaceInputId(cantoFieldId),
    name: "cantoAlbumId" | namespaceInputName(name),
    value: value.cantoAlbumId,
}) }}

{{ forms.hidden({
    id: "cantoAssetData" | namespaceInputId(cantoFieldId),
    name: "cantoAssetData" | namespaceInputName(name),
    value: value.cantoAssetData,
}) }}

{{ forms.hidden({
    id: "cantoAlbumData" | namespaceInputId(cantoFieldId),
    name: "cantoAlbumData" | namespaceInputName(name),
    value: value.cantoAlbumData,
}) }}

    <div style="{% if not previewUrl %} display: none;{% endif %} margin-bottom: 15px;"
         id="{{ "damAssetPreview" | namespaceInputId(cantoFieldId) }}"
         data-thumbnailUrl="{{ previewUrl | default("none") }}"
         data-thumbnailName="{{ previewName | default("none") }}"
         data-albumName="{{ albumName | default("none") }}"
         data-assetCount="{{ assetCount | default("none") }}"
    >
        {% if enabled %}
            <a id="{{ "removeDamAsset" | namespaceInputId(cantoFieldId) }}" class="delete icon" title="Remove"
               style="color:#606D8D; font-weight: bold; font-size: 12px;">&nbsp; Remove Image{% if assetCount != 1 %}s{% endif %}</a>
        {% endif %}
    </div>

{% if enabled %}
    <div class="flex">
        <button
            type="button"
            id="{{ "chooseAsset" | namespaceInputId(cantoFieldId) }}"
            data-field="{{ fieldId }}"
            data-element="{{ elementId }}"
            data-access="{{ accessToken }}"
            class="btn add icon dashed" tabindex="0">
            {% if previewUrl %}
                Choose a Different DAM Asset
            {% else %}
                Select a DAM Asset
            {% endif %}
        </button>
    </div>
{% endif %}
