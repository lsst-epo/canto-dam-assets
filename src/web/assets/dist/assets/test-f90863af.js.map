{"version":3,"file":"test-f90863af.js","sources":["../../../../../buildchain/src/js/test.js"],"sourcesContent":["$(document).ready(function () {\n  // $(\"#uploadBtn\").change(e => {\n  //     console.log(\"uploaded!\");\n  //     console.log(e);\n  // });\n\n  $.cantoUC({\n    env: \"canto.com\",\n  }, replaceCantoTagByImage);\n});\n\nfunction calcImageSize(num) {\n  var size = Math.round(Number(num) / 1024);\n  return size < 1024 ? size + \"KB\" : Math.round(size / 1024) + \"MB\";\n}\n\n// $(\"#uploadBtn\").change(e => {\n//     console.log(\"uploaded!\");\n//     console.log(e);\n// });\n\nfunction replaceCantoTagByImage(id, assetArray) {\n  var body = $(\"body\");\n  var cantoTag = body.find(\"canto\" + \"#\" + id);\n  var imageHtml = \"\";\n  for (var i = 0; i < assetArray.length; i++) {\n    imageHtml += '<div class=\"canto-block\">';\n    imageHtml += '<img class=\"canto-preview-img\" src=\"' + assetArray[i].previewUri + '\">';\n    imageHtml += '<div class=\"canto-preview-name\">Name: ' + assetArray[i].displayName + '</div>';\n    imageHtml += '<div class=\"canto-preview-size\">Size: ' + calcImageSize(assetArray[i].size) + '</div>';\n    imageHtml += '<a class=\"canto-preview-size\" href=\"' + assetArray[i].directUri + '\">Download</a>';\n    imageHtml += '</div>';\n  }\n  cantoTag.replaceWith(imageHtml);\n}\n\n// Beginning of Canto's Universal Connector code:\n(function ($, document, window) {\n  var cantoUC,\n    pluginName = \"cantoUC\",\n    tokenInfo = {},\n    env = \"canto.com\",\n    appId = \"52ff8ed9d6874d48a3bef9621bc1af26\",\n    currentCantoTagID,\n    formatDistrict,\n    timeStamp;\n\n  // $(\"#uploadBtn\").change(e => {\n  //     console.log(\"uploaded!\");\n  //     console.log(e);\n  // });\n\n  cantoUC = $.fn[pluginName] = $[pluginName] = function (options, callback) {\n    settings(options);\n\n    window.onmessage = function (event) {\n      var data = event.data;\n      if (data && data.type == \"getTokenInfo\") {\n        var receiver = document.getElementById('cantoUCFrame').contentWindow;\n        tokenInfo.formatDistrict = formatDistrict;\n        receiver.postMessage(tokenInfo, '*');\n      } else if (data && data.type == \"cantoLogout\") {\n        tokenInfo = {};\n        $(\".canto-uc-iframe-close-btn\").trigger(\"click\");\n\n      } else if (data && data.type == \"cantoInsertImage\") {\n        $(\".canto-uc-iframe-close-btn\").trigger(\"click\");\n        callback(currentCantoTagID, data.assetList);\n\n      } else if (data && data.type == \"closeModal\") {\n        $(\"#fields-dam-preview-image\").remove();\n        $(\"#fields-rosas-clicker\").html(\"Choose a Different DAM Asset\");\n        $(\"#fields-dam-asset-preview\").prepend(`<img id=\"fields-dam-preview-image\" style=\"max-height:200px; max-width:200px;\" src=${data.thumbnailUrl}/>`);\n        $(\"#fields-dam-asset-preview\").show();\n        $modal.hide();\n\n      } else if (data) {\n        let verifyCode = data;\n        getTokenByVerifycode(verifyCode);\n\n      }\n\n    };\n  };\n\n  function settings(options) {\n    env = options.env;\n    formatDistrict = options.extensions;\n  }\n\n  function getTokenByVerifycode(verifyCode) {\n    $.ajax({\n      type: \"POST\",\n      url: \"https://oauth.canto.com/oauth/api/oauth2/universal2/token\",\n      dataType: \"json\",\n      data: {\n        \"app_id\": appId,\n        \"grant_type\": \"authorization_code\",\n        \"redirect_uri\": \"http://localhost:8080\",\n        \"code\": verifyCode,\n        \"code_verifier\": \"1649285048042\"\n      },\n      success: function (data) {\n        tokenInfo = data;\n        getTenant(tokenInfo);\n\n      },\n      error: function (request) {\n        alert(\"Get token errorz\");\n      }\n    });\n  }\n\n  function getTenant(tokenInfo) {\n    $.ajax({\n      type: \"GET\",\n      url: \"https://oauth.\" + env + \":443/oauth/api/oauth2/tenant/\" + tokenInfo.refreshToken,\n      success: function (data) {\n        tokenInfo.tenant = data;\n        console.log(\"in test.js loading UC!\");\n        $(\"#cantoUCFrame\").attr(\"src\", \"/admin/_canto-dam-assets/canto-embed.twig\");\n      },\n      error: function (request) {\n        alert(\"Get tenant error\");\n      }\n    });\n  }\n\n}(jQuery, document, window));\n"],"names":["replaceCantoTagByImage","calcImageSize","num","size","id","assetArray","body","cantoTag","imageHtml","i","$","document","window","pluginName","tokenInfo","env","appId","currentCantoTagID","formatDistrict","options","callback","settings","event","data","receiver","getTokenByVerifycode","verifyCode","getTenant","request"],"mappings":"AAAA,EAAE,QAAQ,EAAE,MAAM,UAAY,CAM5B,EAAE,QAAQ,CACR,IAAK,WACN,EAAEA,CAAsB,CAC3B,CAAC,EAED,SAASC,EAAcC,EAAK,CAC1B,IAAIC,EAAO,KAAK,MAAM,OAAOD,CAAG,EAAI,IAAI,EACxC,OAAOC,EAAO,KAAOA,EAAO,KAAO,KAAK,MAAMA,EAAO,IAAI,EAAI,IAC/D,CAOA,SAASH,EAAuBI,EAAIC,EAAY,CAI9C,QAHIC,EAAO,EAAE,MAAM,EACfC,EAAWD,EAAK,KAAK,SAAgBF,CAAE,EACvCI,EAAY,GACPC,EAAI,EAAGA,EAAIJ,EAAW,OAAQI,IACrCD,GAAa,4BACbA,GAAa,uCAAyCH,EAAWI,CAAC,EAAE,WAAa,KACjFD,GAAa,yCAA2CH,EAAWI,CAAC,EAAE,YAAc,SACpFD,GAAa,yCAA2CP,EAAcI,EAAWI,CAAC,EAAE,IAAI,EAAI,SAC5FD,GAAa,uCAAyCH,EAAWI,CAAC,EAAE,UAAY,iBAChFD,GAAa,SAEfD,EAAS,YAAYC,CAAS,CAChC,EAGC,SAAUE,EAAGC,EAAUC,EAAQ,CAC3B,IACDC,EAAa,UACbC,EAAY,CAAA,EACZC,EAAM,YACNC,EAAQ,mCACRC,EACAC,EAQQR,EAAE,GAAGG,CAAU,EAAIH,EAAEG,CAAU,EAAI,SAAUM,EAASC,EAAU,CACxEC,EAASF,CAAO,EAEhBP,EAAO,UAAY,SAAUU,EAAO,CAClC,IAAIC,EAAOD,EAAM,KACjB,GAAIC,GAAQA,EAAK,MAAQ,eAAgB,CACvC,IAAIC,EAAWb,EAAS,eAAe,cAAc,EAAE,cACvDG,EAAU,eAAiBI,EAC3BM,EAAS,YAAYV,EAAW,GAAG,OAC1BS,GAAQA,EAAK,MAAQ,eAC9BT,EAAY,CAAA,EACZJ,EAAE,4BAA4B,EAAE,QAAQ,OAAO,GAEtCa,GAAQA,EAAK,MAAQ,oBAC9Bb,EAAE,4BAA4B,EAAE,QAAQ,OAAO,EAC/CU,EAASH,EAAmBM,EAAK,SAAS,GAEjCA,GAAQA,EAAK,MAAQ,cAC9Bb,EAAE,2BAA2B,EAAE,SAC/BA,EAAE,uBAAuB,EAAE,KAAK,8BAA8B,EAC9DA,EAAE,2BAA2B,EAAE,QAAQ,qFAAqFa,EAAK,gBAAgB,EACjJb,EAAE,2BAA2B,EAAE,OAC/B,OAAO,KAAI,GAEFa,GAETE,EADiBF,CACc,CAIvC,CACA,EAEE,SAASF,EAASF,EAAS,CACzBJ,EAAMI,EAAQ,IACdD,EAAiBC,EAAQ,UAC1B,CAED,SAASM,EAAqBC,EAAY,CACxChB,EAAE,KAAK,CACL,KAAM,OACN,IAAK,4DACL,SAAU,OACV,KAAM,CACJ,OAAUM,EACV,WAAc,qBACd,aAAgB,wBAChB,KAAQU,EACR,cAAiB,eAClB,EACD,QAAS,SAAUH,EAAM,CACvBT,EAAYS,EACZI,EAAUb,CAAS,CAEpB,EACD,MAAO,SAAUc,EAAS,CACxB,MAAM,kBAAkB,CACzB,CACP,CAAK,CACF,CAED,SAASD,EAAUb,EAAW,CAC5BJ,EAAE,KAAK,CACL,KAAM,MACN,IAAK,iBAAmBK,EAAM,gCAAkCD,EAAU,aAC1E,QAAS,SAAUS,EAAM,CACvBT,EAAU,OAASS,EACnB,QAAQ,IAAI,wBAAwB,EACpCb,EAAE,eAAe,EAAE,KAAK,MAAO,2CAA2C,CAC3E,EACD,MAAO,SAAUkB,EAAS,CACxB,MAAM,kBAAkB,CACzB,CACP,CAAK,CACF,CAEH,GAAE,OAAQ,SAAU,MAAM"}