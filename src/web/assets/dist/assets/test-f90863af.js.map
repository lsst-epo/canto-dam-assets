{"version":3,"file":"test-f90863af.js","sources":["../../../../../buildchain/src/js/test.js"],"sourcesContent":["$(document).ready(function () {\r\n  // $(\"#uploadBtn\").change(e => {\r\n  //     console.log(\"uploaded!\");\r\n  //     console.log(e);\r\n  // });\r\n\r\n  $.cantoUC({\r\n    env: \"canto.com\",\r\n  }, replaceCantoTagByImage);\r\n});\r\n\r\nfunction calcImageSize(num) {\r\n  var size = Math.round(Number(num) / 1024);\r\n  return size < 1024 ? size + \"KB\" : Math.round(size / 1024) + \"MB\";\r\n}\r\n\r\n// $(\"#uploadBtn\").change(e => {\r\n//     console.log(\"uploaded!\");\r\n//     console.log(e);\r\n// });\r\n\r\nfunction replaceCantoTagByImage(id, assetArray) {\r\n  var body = $(\"body\");\r\n  var cantoTag = body.find(\"canto\" + \"#\" + id);\r\n  var imageHtml = \"\";\r\n  for (var i = 0; i < assetArray.length; i++) {\r\n    imageHtml += '<div class=\"canto-block\">';\r\n    imageHtml += '<img class=\"canto-preview-img\" src=\"' + assetArray[i].previewUri + '\">';\r\n    imageHtml += '<div class=\"canto-preview-name\">Name: ' + assetArray[i].displayName + '</div>';\r\n    imageHtml += '<div class=\"canto-preview-size\">Size: ' + calcImageSize(assetArray[i].size) + '</div>';\r\n    imageHtml += '<a class=\"canto-preview-size\" href=\"' + assetArray[i].directUri + '\">Download</a>';\r\n    imageHtml += '</div>';\r\n  }\r\n  cantoTag.replaceWith(imageHtml);\r\n}\r\n\r\n// Beginning of Canto's Universal Connector code:\r\n(function ($, document, window) {\r\n  var cantoUC,\r\n    pluginName = \"cantoUC\",\r\n    tokenInfo = {},\r\n    env = \"canto.com\",\r\n    appId = \"52ff8ed9d6874d48a3bef9621bc1af26\",\r\n    currentCantoTagID,\r\n    formatDistrict,\r\n    timeStamp;\r\n\r\n  // $(\"#uploadBtn\").change(e => {\r\n  //     console.log(\"uploaded!\");\r\n  //     console.log(e);\r\n  // });\r\n\r\n  cantoUC = $.fn[pluginName] = $[pluginName] = function (options, callback) {\r\n    settings(options);\r\n\r\n    window.onmessage = function (event) {\r\n      var data = event.data;\r\n      if (data && data.type == \"getTokenInfo\") {\r\n        var receiver = document.getElementById('cantoUCFrame').contentWindow;\r\n        tokenInfo.formatDistrict = formatDistrict;\r\n        receiver.postMessage(tokenInfo, '*');\r\n      } else if (data && data.type == \"cantoLogout\") {\r\n        tokenInfo = {};\r\n        $(\".canto-uc-iframe-close-btn\").trigger(\"click\");\r\n\r\n      } else if (data && data.type == \"cantoInsertImage\") {\r\n        $(\".canto-uc-iframe-close-btn\").trigger(\"click\");\r\n        callback(currentCantoTagID, data.assetList);\r\n\r\n      } else if (data && data.type == \"closeModal\") {\r\n        $(\"#fields-dam-preview-image\").remove();\r\n        $(\"#fields-rosas-clicker\").html(\"Choose a Different DAM Asset\");\r\n        $(\"#fields-dam-asset-preview\").prepend(`<img id=\"fields-dam-preview-image\" style=\"max-height:200px; max-width:200px;\" src=${data.thumbnailUrl}/>`);\r\n        $(\"#fields-dam-asset-preview\").show();\r\n        $modal.hide();\r\n\r\n      } else if (data) {\r\n        let verifyCode = data;\r\n        getTokenByVerifycode(verifyCode);\r\n\r\n      }\r\n\r\n    };\r\n  };\r\n\r\n  function settings(options) {\r\n    env = options.env;\r\n    formatDistrict = options.extensions;\r\n  }\r\n\r\n  function getTokenByVerifycode(verifyCode) {\r\n    $.ajax({\r\n      type: \"POST\",\r\n      url: \"https://oauth.canto.com/oauth/api/oauth2/universal2/token\",\r\n      dataType: \"json\",\r\n      data: {\r\n        \"app_id\": appId,\r\n        \"grant_type\": \"authorization_code\",\r\n        \"redirect_uri\": \"http://localhost:8080\",\r\n        \"code\": verifyCode,\r\n        \"code_verifier\": \"1649285048042\"\r\n      },\r\n      success: function (data) {\r\n        tokenInfo = data;\r\n        getTenant(tokenInfo);\r\n\r\n      },\r\n      error: function (request) {\r\n        alert(\"Get token errorz\");\r\n      }\r\n    });\r\n  }\r\n\r\n  function getTenant(tokenInfo) {\r\n    $.ajax({\r\n      type: \"GET\",\r\n      url: \"https://oauth.\" + env + \":443/oauth/api/oauth2/tenant/\" + tokenInfo.refreshToken,\r\n      success: function (data) {\r\n        tokenInfo.tenant = data;\r\n        console.log(\"in test.js loading UC!\");\r\n        $(\"#cantoUCFrame\").attr(\"src\", \"/admin/_canto-dam-assets/canto-embed.twig\");\r\n      },\r\n      error: function (request) {\r\n        alert(\"Get tenant error\");\r\n      }\r\n    });\r\n  }\r\n\r\n}(jQuery, document, window));\r\n"],"names":["replaceCantoTagByImage","calcImageSize","num","size","id","assetArray","body","cantoTag","imageHtml","i","$","document","window","pluginName","tokenInfo","env","appId","currentCantoTagID","formatDistrict","options","callback","settings","event","data","receiver","getTokenByVerifycode","verifyCode","getTenant","request"],"mappings":"AAAA,EAAE,QAAQ,EAAE,MAAM,UAAY,CAM5B,EAAE,QAAQ,CACR,IAAK,WACN,EAAEA,CAAsB,CAC3B,CAAC,EAED,SAASC,EAAcC,EAAK,CAC1B,IAAIC,EAAO,KAAK,MAAM,OAAOD,CAAG,EAAI,IAAI,EACxC,OAAOC,EAAO,KAAOA,EAAO,KAAO,KAAK,MAAMA,EAAO,IAAI,EAAI,IAC/D,CAOA,SAASH,EAAuBI,EAAIC,EAAY,CAI9C,QAHIC,EAAO,EAAE,MAAM,EACfC,EAAWD,EAAK,KAAK,SAAgBF,CAAE,EACvCI,EAAY,GACPC,EAAI,EAAGA,EAAIJ,EAAW,OAAQI,IACrCD,GAAa,4BACbA,GAAa,uCAAyCH,EAAWI,CAAC,EAAE,WAAa,KACjFD,GAAa,yCAA2CH,EAAWI,CAAC,EAAE,YAAc,SACpFD,GAAa,yCAA2CP,EAAcI,EAAWI,CAAC,EAAE,IAAI,EAAI,SAC5FD,GAAa,uCAAyCH,EAAWI,CAAC,EAAE,UAAY,iBAChFD,GAAa,SAEfD,EAAS,YAAYC,CAAS,CAChC,EAGC,SAAUE,EAAGC,EAAUC,EAAQ,CAC3B,IACDC,EAAa,UACbC,EAAY,CAAA,EACZC,EAAM,YACNC,EAAQ,mCACRC,EACAC,EASJR,EAAI,GAAQG,CAAQ,EAACH,EAACG,CAAA,EAAA,SAAAM,EAAAC,EAAA,CACtBC,EAAAF,CAAA,EAEAP,EAAc,UAAS,SAAKU,EAAA,CACtB,IAAIC,EAAQD,EAAK,KACf,GAAAC,GAAYA,EAAG,MAAQ,eAAgB,CACvC,IAASC,EAAeb,EAAA,6BAAkB,EAAA,cAC1CG,EAAoB,iBACrBU,EAAU,YAAYV,EAAS,GAAA,OACrBS,GAAMA,EAAA,MAAA,eACfT,EAA8B,CAAA,EACtCJ,EAAA,4BAAA,EAAA,QAAA,OAAA,GAEsCa,GAAAA,EAAA,MAAA,oBAC9Bb,EAAA,8BAAgC,QAAC,OAAW,EACpDU,EAAAH,EAAAM,EAAA,SAAA,GAEUA,GAAAA,EAAA,MAA4B,cAC9Bb,EAAE,2BAA6B,EAAA,OAA+B,EAC9DA,EAAE,uBAAA,EAAA,mCAAwH,EAC1HA,EAAE,2BAA2B,EAAE,QAAO,qFAAAa,EAAA,gBAAA,EACtCb,EAAM,2BAAQ,EAAA,KAAA,EACtB,OAAA,KAAA,GAEYa,GAEZE,EAD4BF,CAC5B,CAII,CACJ,EAEA,SAAiBF,IAAK,CAClBN,EAAcI,EAAA,IACfD,EAAAC,EAAA,UACH,CAEI,SAAOM,EAAAC,EAAA,CACLhB,EAAA,MACA,KAAgE,OAChE,IAAA,4DACA,SAAM,OACJ,KAAA,CACA,OAAAM,EACA,WAAc,qBACd,aAAkB,wBAClB,KAAAU,EACD,cAAA,eACD,EACE,QAAA,SAAiBH,EAAA,CACjBT,EAAmBS,EAC3BI,EAAAb,CAAA,CAEM,EACN,MAAa,SAAmBc,EAAA,CACzB,MAAA,kBAAA,CACD,CACH,CAAA,CACH,CAEI,SAAOD,EAAAb,EAAA,CACLJ,EAAA,MACA,KAAK,MACL,IAAO,iBAAkBK,EAAA,gCAAAD,EAAA,aAC/B,QAAiB,SAAOS,EAAO,CACvBT,EAAQ,OAAIS,EACZ,QAAE,IAAA,wBAAwE,EAC3Eb,EAAA,eAAA,EAAA,KAAA,MAAA,2CAAA,CACD,EACN,MAAa,SAAmBkB,EAAA,CACzB,MAAA,kBAAA,CACD,CACH,CAAA,CACH"}