{"version":3,"file":"canto-embed-c7d76491.js","sources":["../../../../../buildchain/src/js/canto-embed.js"],"sourcesContent":["let cantoViewDom = {};\r\nlet _accessToken = \"\";\r\nlet _refreshToken = \"\";\r\nlet _tokenType = \"\";\r\nlet _tenants = \"\";\r\nlet cantoAPI = {};\r\nlet _APIHeaders = {};\r\nlet searchedBy = \"\"; //bySearch bytree byScheme''\r\nlet currentImageList = [];\r\nlet singleCountLoad = 50;\r\nlet apiNextStart = 0;\r\nlet isLoadingComplete = false;\r\nlet _formatDistrict = '';\r\n\r\n/* -----------------canto API start-------------------------------------------------------------*/\r\n\r\nfunction setToken(tokenInfo) {\r\n  _accessToken = tokenInfo.accessToken;\r\n  _tenants = tokenInfo.tenant ? tokenInfo.tenant : \"rubin.canto.com/\";\r\n  _tokenType = tokenInfo.tokenType ? tokenInfo.tokenType : \"bearer\";\r\n  _APIHeaders = {\r\n    \"Authorization\": _tokenType + \" \" + _accessToken,\r\n    \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n  };\r\n  _formatDistrict = tokenInfo.formatDistrict;\r\n}\r\n\r\ncantoAPI.loadTree = function (callback) {\r\n  var url = \"https://\" + _tenants + \"/api/v1/tree?sortBy=name&sortDirection=ascending&layer=1\";\r\n  $.ajax({\r\n    headers: _APIHeaders,\r\n    type: \"GET\",\r\n    url: url,\r\n    async: true,\r\n    error: function (request) {\r\n      alert(\"load tree error\");\r\n    },\r\n    success: function (data) {\r\n      callback(data.results);\r\n    }\r\n  });\r\n};\r\ncantoAPI.loadSubTree = function (treeID, callback) {\r\n  let url = `https://${_tenants}/api/v1/tree/${treeID}`;\r\n  $.ajax({\r\n    headers: _APIHeaders,\r\n    type: \"GET\",\r\n    url: url,\r\n    async: true,\r\n    error: function (request) {\r\n      alert(\"load tree error\");\r\n    },\r\n    success: function (data) {\r\n      callback(data.results);\r\n    }\r\n  });\r\n};\r\ncantoAPI.getListByAlbum = function (albumID, callback) {\r\n  if (isLoadingComplete) {\r\n    return;\r\n  }\r\n  let filterString = loadMoreHandler();\r\n  let url = `https://${_tenants}/api/v1/album/${albumID}?${filterString}`;\r\n  $.ajax({\r\n    type: \"GET\",\r\n    headers: _APIHeaders,\r\n    url: url,\r\n    async: true,\r\n    error: function (request) {\r\n      alert(\"load list error\");\r\n    },\r\n    success: function (data) {\r\n      currentImageList.push.apply(currentImageList, data.results);\r\n      if (!data.start) {\r\n        data.start = 0;\r\n      }\r\n      if (data.found - data.limit <= data.start) {\r\n        isLoadingComplete = true;\r\n      } else {\r\n        isLoadingComplete = false;\r\n      }\r\n      apiNextStart = data.start + data.limit + 1;\r\n      $(\"#loadingMore\").delay(1500).fadeOut(\"slow\");\r\n      callback(data.results);\r\n    }\r\n  });\r\n};\r\ncantoAPI.getRedirectURL = function (previewURL, ID) {\r\n  if (!(previewURL && ID)) return;\r\n  let url = previewURL + 'URI';\r\n  $.ajax({\r\n    type: \"GET\",\r\n    headers: _APIHeaders,\r\n    url: url,\r\n    error: function (request) {\r\n      console.error(request.getError());\r\n    },\r\n    success: function (data) {\r\n      $(\"img#\" + ID).attr('src', data);\r\n    }\r\n  });\r\n};\r\ncantoAPI.getHugeRedirectURL = function (previewURL, ID) {\r\n  if (!(previewURL && ID)) return;\r\n  let url = `${previewURL}URI/2000`;\r\n  $.ajax({\r\n    type: \"GET\",\r\n    headers: _APIHeaders,\r\n    url: url,\r\n    error: function (request) {\r\n      console.error(request.getError());\r\n    },\r\n    success: function (data) {\r\n      let $viewImageModal = $(\"#cantoViewBody\").find(\"#imageBox\");\r\n      $viewImageModal.find(\"img\").attr(\"src\", data);\r\n    }\r\n  });\r\n};\r\n\r\n\r\ncantoAPI.getListByScheme = function (scheme, callback) {\r\n  if (scheme == \"allfile\") {\r\n    let data = {scheme: \"allfile\", keywords: \"\"};\r\n    cantoAPI.getFilterList(data, callback);\r\n  } else {\r\n    if (isLoadingComplete) {\r\n      return;\r\n    }\r\n    let filterString = loadMoreHandler();\r\n    let url = `https://${_tenants}/api/v1/${scheme}?${filterString}`;\r\n    $.ajax({\r\n      type: \"GET\",\r\n      headers: _APIHeaders,\r\n      url: url,\r\n      async: false,\r\n      error: function (request) {\r\n        alert(\"load list error\");\r\n      },\r\n      success: function (data) {\r\n        currentImageList.push.apply(currentImageList, data.results);\r\n        if (!data.start) {\r\n          data.start = 0;\r\n        }\r\n        if (data.found - data.limit <= data.start) {\r\n          isLoadingComplete = true;\r\n        } else {\r\n          isLoadingComplete = false;\r\n        }\r\n        apiNextStart = data.start + data.limit + 1;\r\n        $(\"#loadingMore\").delay(1500).fadeOut(\"slow\");\r\n        callback(data.results);\r\n      }\r\n    });\r\n  }\r\n\r\n};\r\n\r\ncantoAPI.getDetail = function (contentID, scheme, callback) {\r\n  let url = `https://${_tenants}/api/v1/${scheme}/${contentID}`;\r\n  $.ajax({\r\n    type: \"GET\",\r\n    headers: _APIHeaders,\r\n    url: url,\r\n    async: true,\r\n    error: function (request) {\r\n      alert(\"load detail error\");\r\n    },\r\n    success: function (data) {\r\n      callback(data);\r\n    }\r\n  });\r\n};\r\n\r\ncantoAPI.getFilterList = function (data, callback) {\r\n  if (isLoadingComplete) {\r\n    return;\r\n  }\r\n  let filterString = loadMoreHandler();\r\n  let url = `https://${_tenants}/api/v1/search?${filterString}`;\r\n  url += `&keyword=${data.keywords}`;\r\n  if (data.scheme && data.scheme == \"allfile\") {\r\n    url += `&scheme=${encodeURIComponent(\"image|presentation|document|audio|video|other\")}`;\r\n  } else if (data.scheme) {\r\n    url += `&scheme=${data.scheme}`;\r\n  }\r\n  $.ajax({\r\n    type: \"GET\",\r\n    headers: _APIHeaders,\r\n    url: url,\r\n    async: false,\r\n    error: function (request) {\r\n      alert(\"load List error\");\r\n    },\r\n    success: function (data) {\r\n      currentImageList.push.apply(currentImageList, data.results);\r\n      if (!data.start) {\r\n        data.start = 0;\r\n      }\r\n      if (data.found - data.limit <= data.start) {\r\n        isLoadingComplete = true;\r\n      } else {\r\n        isLoadingComplete = false;\r\n      }\r\n      apiNextStart = data.start + data.limit + 1;\r\n      $(\"#loadingMore\").delay(1500).fadeOut(\"slow\");\r\n      callback(data.results);\r\n    }\r\n  });\r\n};\r\n\r\ncantoAPI.logout = function () {\r\n  //clear cookie and trun to login page.\r\n  let targetWindow = parent;\r\n  let data = {};\r\n  data.type = \"cantoLogout\";\r\n  targetWindow.postMessage(data, '*');\r\n};\r\n\r\ncantoAPI.insertImage = function (imageArray) {\r\n  //clear cookie and trun to login page.\r\n  if (!(imageArray && imageArray.length)) {\r\n    return;\r\n  }\r\n  let data = {};\r\n  data.type = \"cantoInsertImage\";\r\n  data.assetList = [];\r\n\r\n  let url = `https://${_tenants}/api_binary/v1/batch/directuri`;\r\n\r\n  fetch(url, {\r\n    method: \"post\",\r\n    headers: {\r\n      \"Authorization\": `${_tokenType} ${_accessToken}`,\r\n      \"Content-Type\": \"application/json; charset=utf-8\"\r\n    },\r\n    body: JSON.stringify(imageArray)\r\n  }).then(response => {\r\n    return response.json();\r\n  }).then(resp => {\r\n    for (let i = 0; i < resp.length; i++) {\r\n      for (let j = 0; j < imageArray.length; j++) {\r\n        if (resp[i].id == imageArray[j].id) {\r\n          resp[i].size = imageArray[j].size;\r\n        }\r\n      }\r\n    }\r\n    fetch(\"/canto-dam-integrator/dam-asset-upload\", {\r\n      method: \"post\",\r\n      headers: {\"Content-Type\": \"application/json; charset=utf-8\"},\r\n      body: JSON.stringify({\r\n        cantoId: resp[0].id,\r\n        fieldId: window.frameElement.getAttribute(\"data-field\"),\r\n        elementId: window.frameElement.getAttribute(\"data-element\"),\r\n        entryType: window.frameElement.getAttribute(\"data-type\")\r\n      }),\r\n    }).then(response => {\r\n      return response.json();\r\n    }).then(resp => {\r\n      let targetWindow = parent;\r\n      let data = {};\r\n      data.type = \"closeModal\";\r\n      data.thumbnailUrl = JSON.parse(resp)[\"asset_thumbnail\"];\r\n      targetWindow.postMessage(data, '*');\r\n    });\r\n    data.assetList = resp;\r\n    let targetWindow = parent;\r\n    targetWindow.postMessage(data, '*');\r\n  });\r\n};\r\n\r\n/* -----------------canto API end--------------------------------------------------------*/\r\n\r\n$(document).ready(function () {\r\n  getFrameDom();\r\n  addEventListener();\r\n  getTokenInfo();\r\n\r\n  window.onmessage = function (event) {\r\n    let tokenInfo = event.data;\r\n\r\n    if (tokenInfo && tokenInfo.accessToken && tokenInfo.accessToken.length > 0) {\r\n      setToken(tokenInfo);\r\n    } else {\r\n      setToken({\r\n        accessToken: parent.document.querySelector(\"#cantoUCFrame\").dataset.access\r\n      });\r\n    }\r\n    treeviewDataHandler();\r\n    let initSchme = $(\"#cantoViewBody\").find(\".type-font.current\").data(\"type\");\r\n    $(\"#cantoViewBody\").find(\"#globalSearch input\").val(\"\");\r\n    getImageInit(initSchme);\r\n  };\r\n});\r\n\r\nfunction getTokenInfo() {\r\n  let targetWindow = parent;\r\n  let data = {};\r\n  data.type = \"getTokenInfo\";\r\n  targetWindow.postMessage(data, '*');\r\n}\r\n\r\nfunction getFrameDom() {\r\n  let parentDocument = document;\r\n  let contentIframe = document.getElementsByClassName('canto-uc-subiframe')[0];\r\n  if (contentIframe) {\r\n    parentDocument = contentIframe.contentDocument;\r\n  }\r\n  cantoViewDom = parentDocument;\r\n}\r\n\r\nfunction addEventListener() {\r\n  document.addEventListener('sendTokenInfo', function (e) {\r\n    let tokenInfo = e.data;\r\n    _accessToken = tokenInfo.accessToken;\r\n    _refreshToken = tokenInfo.refreshToken;\r\n    _tokenType = tokenInfo.tokenType;\r\n  });\r\n\r\n  $(document).off('click').on(\"click\", \"#treeviewSwitch\", function (e) {\r\n      if ($('#treeviewSection').hasClass(\"expanded\")) {\r\n        $('#treeviewSection').stop().animate({\r\n          left: '-20%'\r\n        });\r\n        $('#cantoImageBody').stop().animate({\r\n          width: '100%',\r\n          left: '0'\r\n        }, imageResize);\r\n        $('#treeviewSection').removeClass(\"expanded\");\r\n        $(\"#loadingMore\").addClass(\"no-treeview\");\r\n        $(\"#noItem\").addClass(\"no-treeview\");\r\n        $(\".max-select-tips\").addClass(\"no-treeview\");\r\n      } else {\r\n        $('#treeviewSection').stop().animate({\r\n          left: '0px'\r\n        });\r\n        $('#cantoImageBody').stop().animate({\r\n          width: '80%',\r\n          left: '20%'\r\n        }, imageResize);\r\n        $('#treeviewSection').addClass(\"expanded\");\r\n        $(\"#loadingMore\").removeClass(\"no-treeview\");\r\n        $(\"#noItem\").removeClass(\"no-treeview\");\r\n        $(\".max-select-tips\").removeClass(\"no-treeview\");\r\n      }\r\n\r\n    })\r\n    .on(\"click\", \".type-font\", function (e) {\r\n      searchedBy = \"byScheme\";\r\n      $(\".type-font\").removeClass(\"current\");\r\n      $(this).addClass(\"current\");\r\n      // let type = $(this).data(\"type\");\r\n      $(\"#cantoViewBody\").find(\"#globalSearch input\").val(\"\");\r\n      $(\"#cantoViewBody\").find(\"#treeviewSection ul li\").removeClass(\"selected\");\r\n\r\n      let data = {};\r\n      data.scheme = $(\"#cantoViewBody\").find(\".type-font.current\").data(\"type\");\r\n      data.keywords = \"\";\r\n      $(\"#cantoViewBody\").find(\"#imagesContent\").html(\"\");\r\n      $(\"#cantoViewBody\").find(\"#imagesContent\").scrollTop(0);\r\n      isLoadingComplete = false;\r\n      currentImageList = [];\r\n      cantoAPI.getFilterList(data, imageListDisplay);\r\n\r\n    })\r\n    .on(\"click\", \"#selectAllBtn\", function (e) {\r\n      $(\"#cantoViewBody\").find('.single-image .select-box').removeClass(\"icon-s-Ok2_32\");\r\n      $(\"#cantoViewBody\").find(\".single-image\").removeClass(\"selected\");\r\n      handleSelectedMode();\r\n    })\r\n    .on(\"click\", \"#insertAssetsBtn\", function (e) {\r\n      $(\"#cantoViewBody\").find(\".loading-icon\").removeClass(\"hidden\");\r\n      let assetArray = [];\r\n      let selectedArray = $(\"#cantoViewBody\").find(\".single-image .icon-s-Ok2_32\").closest(\".single-image\");\r\n      for (let i = 0; i < selectedArray.length; i++) {\r\n        let obj = {};\r\n        obj.id = $(selectedArray[i]).data(\"id\");\r\n        obj.scheme = $(selectedArray[i]).data(\"scheme\");\r\n        obj.size = $(selectedArray[i]).data(\"size\");\r\n        assetArray.push(obj);\r\n      }\r\n      cantoAPI.insertImage(assetArray);\r\n    })\r\n    .on(\"click\", \".icon-s-Fullscreen\", function (e) {\r\n      e.cancelBubble = true;\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n      $(\"#cantoViewBody\").find(\".loading-icon\").removeClass(\"hidden\");\r\n      let targetURL = $(e.currentTarget).closest(\".single-image\").data(\"xurl\");\r\n      let previewURL = targetURL + \"?Authorization=\" + _accessToken;\r\n      displayFullyImage(previewURL);\r\n    })\r\n    .on(\"click\", \".single-image\", function (e) {\r\n      $(\"#cantoViewBody\").find(\".loading-icon\").removeClass(\"hidden\");\r\n      //display image\r\n      let targetURL = $(e.currentTarget).closest(\".single-image\").data(\"xurl\");\r\n      let targetID = $(e.currentTarget).closest(\".single-image\").data(\"id\");\r\n      cantoAPI.getHugeRedirectURL(targetURL, targetID);\r\n      //display detail\r\n      let id = $(this).data(\"id\");\r\n      let scheme = $(this).data(\"scheme\");\r\n      cantoAPI.getDetail(id, scheme, imageNewDetail);\r\n    })\r\n    .on(\"click\", \"#logoutBtn\", function (e) {\r\n      $(\".loading-icon\").removeClass(\"hidden\");\r\n      cantoAPI.logout();\r\n    })\r\n    //treeview event\r\n    .on(\"click\", \"#treeviewSection ul li\", function (e) {\r\n      e.cancelBubble = true;\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n      let childList = $(e.currentTarget).children(\"ul\");\r\n      // childList.toggleClass(\"hidden\");\r\n      if (\"treeviewContent\" == $(e.currentTarget)[0].id) {\r\n        //load init image list.\r\n        $(\"#cantoViewBody\").find(\"#globalSearch input\").val(\"\");\r\n        $(\"#cantoViewBody\").find(\"#treeviewSection ul li\").removeClass(\"selected\");\r\n        $(\"#cantoViewBody\").find(\".type-font\").removeClass(\"current\");\r\n        $(\"#cantoViewBody\").find(\"#imagesContent\").html(\"\");\r\n        $(\"#cantoViewBody\").find(\"#imagesContent\").scrollTop(0);\r\n        currentImageList = [];\r\n        searchedBy = \"\";\r\n        isLoadingComplete = false;\r\n        console.log(\"line 499\");\r\n        getImageInit(\"allfile\");\r\n\r\n      } else if (childList && childList.length) {\r\n        childList.animate({\r\n          height: 'toggle'\r\n        });\r\n      } else if ($(e.currentTarget).hasClass(\"has-sub-folder\")) {\r\n        subTreeId = $(e.currentTarget).data(\"id\");\r\n        $(e.currentTarget).addClass(\"current-tree-node\");\r\n        $(e.currentTarget).find(\".folder-loading\").removeClass(\"hidden\");\r\n        $(e.currentTarget).find(\".icon-s-Folder_open-20px\").addClass(\"hidden\");\r\n        cantoAPI.loadSubTree(subTreeId, subTreeRender);\r\n\r\n      } else {\r\n        $(\"#treeviewSection ul li\").removeClass(\"selected\");\r\n        $(\"#cantoViewBody\").find(\".type-font\").removeClass(\"current\");\r\n        $(e.currentTarget).addClass(\"selected\");\r\n        $(\"#cantoViewBody\").find(\"#globalSearch input\").val(\"\");\r\n        $(\"#cantoViewBody\").find(\"#imagesContent\").html(\"\");\r\n        $(\"#cantoViewBody\").find(\"#imagesContent\").scrollTop(0);\r\n        currentImageList = [];\r\n        isLoadingComplete = false;\r\n        searchedBy = \"bytree\";\r\n        let albumId = $(e.currentTarget).data(\"id\");\r\n        cantoAPI.getListByAlbum(albumId, imageListDisplay);\r\n      }\r\n\r\n    })\r\n    .on(\"click\", \"#globalSearchBtn\", function (e) {\r\n      let value = $(\"#cantoViewBody\").find(\"#globalSearch input\").val();\r\n      if (!value) {\r\n        //load init image list.\r\n        $(\"#cantoViewBody\").find(\"#treeviewSection ul li\").removeClass(\"selected\");\r\n        let initSchme = $(\"#cantoViewBody\").find(\".type-font.current\").data(\"type\");\r\n        $(\"#cantoViewBody\").find(\"#globalSearch input\").val(\"\");\r\n        $(\"#cantoViewBody\").find(\"#imagesContent\").html(\"\");\r\n        $(\"#cantoViewBody\").find(\"#imagesContent\").scrollTop(0);\r\n        currentImageList = [];\r\n        searchedBy = \"\";\r\n        isLoadingComplete = false;\r\n        console.log(\"line 492\");\r\n        getImageInit(initSchme);\r\n      }\r\n      searchedBy = \"bySearch\";\r\n      isLoadingComplete = false;\r\n      $(\"#cantoViewBody\").find(\"#treeviewSection ul li\").removeClass(\"selected\");\r\n      $(\"#cantoViewBody\").find(\".type-font\").removeClass(\"current\");\r\n      let initSchme = $(\"#cantoViewBody\").find(\".type-font.current\").data(\"type\");\r\n      let data = {};\r\n      data.scheme = initSchme;\r\n      data.keywords = value;\r\n      $(\"#cantoViewBody\").find(\"#imagesContent\").html(\"\");\r\n      $(\"#cantoViewBody\").find(\"#imagesContent\").scrollTop(0);\r\n      currentImageList = [];\r\n      cantoAPI.getFilterList(data, imageListDisplay);\r\n    });\r\n  $(\"#cantoViewBody\").find(\"#cantoImageBody\").on(\"scroll\", function () {\r\n    if (isScrollToPageBottom() && !isLoadingComplete) {\r\n      loadMoreAction();\r\n    }\r\n  });\r\n\r\n  let inputObj = $(\"#cantoViewBody\").find(\"#globalSearch input\");\r\n  $(inputObj).bind('keyup', function (event) {\r\n    if (event.keyCode == \"13\") {\r\n      $(\"#cantoViewBody\").find('#globalSearchBtn').click();\r\n    }\r\n  });\r\n\r\n  let imageListSection = $(\"#cantoViewBody\").find(\"#cantoImageBody\");\r\n  $(imageListSection).resize(function () {\r\n    imageResize();\r\n  });\r\n}\r\n\r\nfunction getImageInit(scheme) {\r\n  console.log(\"inside of getImageInit()!\");\r\n  console.log(\"schema: \", scheme);\r\n  cantoAPI.getListByScheme(scheme, imageListDisplay);\r\n}\r\n\r\nfunction imageListDisplay(imageList) {\r\n  if (!(imageList && imageList.length > 0)) {\r\n    return;\r\n  }\r\n  let formatArr = [];\r\n  if (_formatDistrict && _formatDistrict.length > 1) {\r\n    formatArr = _formatDistrict.split(\";\");\r\n  }\r\n  for (let i = 0; i < imageList.length; i++) {\r\n    let d = imageList[i];\r\n    let extension = d.name.substring(d.name.lastIndexOf('.') + 1);\r\n    if (formatArr.length && !formatArr.includes(extension)) {\r\n      continue;\r\n    }\r\n    let html = \"\";\r\n    let disname = d.name;\r\n    if (d.name.length > 150) {\r\n      disname = d.name.substr(0, 142) + '...' + d.name.substr(-5);\r\n    }\r\n    html += `<div class=\"single-image\" data-id=\"${d.id}\" data-scheme=\"${d.scheme}\" data-xurl=\"${d.url.preview}\" data-name=\"${d.name}\" data-size=\"${d.size}\" >\r\n                    <img id=\"${d.id}\" src=\"https://s3-us-west-2.amazonaws.com/static.dmc/universal/icon/back.png\" alt=\"${d.scheme}\">\r\n                    <div class=\"mask-layer\"></div>\r\n                    <div class=\"single-image-name\">${disname}</div>\r\n                    <span class=\"select-box icon-s-UnselectedCheck_32  \"></span><span class=\"select-icon-background\"></span>\r\n                </div>`;\r\n    $(\"#cantoViewBody\").find(\"#imagesContent\").append(html);\r\n    cantoAPI.getRedirectURL(d.url.preview, d.id);\r\n  }\r\n  let currentCount = $(\"#cantoViewBody\").find('.single-image').length;\r\n  if (currentCount == 0) {\r\n    $(\"#cantoViewBody\").find(\"#noItem\").removeClass(\"hidden\");\r\n  } else {\r\n    $(\"#cantoViewBody\").find(\"#noItem\").addClass(\"hidden\");\r\n  }\r\n  let rem = [];\r\n  $(\"#cantoViewBody\").find('.single-image').hover(function () {\r\n    let nameTop = $(this).height() - $(this).find(\".single-image-name\").height() - 20;\r\n    $(this).find('.single-image-name').stop().animate({top: nameTop});\r\n  }, function () {\r\n    $(this).find('.single-image-name').stop().animate({top: '100%'});\r\n  });\r\n  $(\"#cantoViewBody\").find('.single-image .select-box').off('click').on('click', function (e) {\r\n    e.cancelBubble = true;\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n\r\n    rem.push($(\".single-image\").index($(this).closest(\".single-image\")));\r\n    if (e.shiftKey) {\r\n      let iMin = Math.min(rem[rem.length - 2], rem[rem.length - 1]);\r\n      let iMax = Math.max(rem[rem.length - 2], rem[rem.length - 1]);\r\n      for (i = iMin; i <= iMax; i++) {\r\n        let selectedCount = $(\"#cantoViewBody\").find(\".single-image .icon-s-Ok2_32\").length;\r\n        if (selectedCount >= 20) {\r\n          $(\".max-select-tips\").fadeIn(\"normal\").delay(2000).fadeOut(1000);\r\n          return;\r\n        }\r\n        $(\".single-image:eq(\" + i + \") .select-box\").addClass(\"icon-s-Ok2_32\");\r\n        $(\".single-image:eq(\" + i + \")\").addClass(\"selected\");\r\n      }\r\n    } else {\r\n      let selectedCount = $(\"#cantoViewBody\").find(\".single-image .icon-s-Ok2_32\").length;\r\n      if (selectedCount >= 20) {\r\n        if (!$(this).hasClass(\"icon-s-Ok2_32\")) {\r\n          $(\".max-select-tips\").fadeIn(\"normal\").delay(2000).fadeOut(1000);\r\n        }\r\n        $(this).removeClass(\"icon-s-Ok2_32\");\r\n        $(this).closest(\".single-image\").removeClass(\"selected\");\r\n        return;\r\n      } else {\r\n        $(this).toggleClass(\"icon-s-Ok2_32\");\r\n        $(this).closest(\".single-image\").toggleClass(\"selected\");\r\n      }\r\n\r\n    }\r\n    handleSelectedMode();\r\n  });\r\n  imageResize();\r\n  handleSelectedMode();\r\n\r\n  let bodyHeight = $(\"#cantoImageBody\").height();\r\n  let documentHeight = $(\"#imagesContent\").height();\r\n  if (documentHeight < bodyHeight && !isLoadingComplete) {\r\n    loadMoreAction();\r\n  }\r\n}\r\n\r\nlet handleSelectedMode = function () {\r\n  let selectedCount = $(\"#cantoViewBody\").find(\".single-image .icon-s-Ok2_32\").length;\r\n  $(\"#cantoViewBody\").find(\"#selected-count\").html(selectedCount);\r\n  if (selectedCount) {\r\n    $(\"#cantoViewBody\").find(\"#globalSearch\").addClass(\"hidden\");\r\n    $(\"#cantoViewBody\").find(\"#filterSection\").addClass(\"hidden\");\r\n    $(\"#cantoViewBody\").find(\"#selectedCountSection\").removeClass(\"hidden\");\r\n    $(\"#cantoViewBody\").find(\"#selectedActionSection\").removeClass(\"hidden\");\r\n  } else {\r\n    $(\"#cantoViewBody\").find(\"#globalSearch\").removeClass(\"hidden\");\r\n    $(\"#cantoViewBody\").find(\"#filterSection\").removeClass(\"hidden\");\r\n    $(\"#cantoViewBody\").find(\"#selectedCountSection\").addClass(\"hidden\");\r\n    $(\"#cantoViewBody\").find(\"#selectedActionSection\").addClass(\"hidden\");\r\n  }\r\n  //toggle isAllSelectedMode\r\n  $(\"#cantoViewBody\").find(\"#selectAllBtn\").addClass(\"all-selected\");\r\n  $(\"#cantoViewBody\").find(\"#selectAllBtn\").attr(\"title\", \"Deselect All\");\r\n};\r\nlet resetImageURL = function (id, url) {\r\n  let imgDom = $(\"#cantoViewBody\").find(\"#\" + id);\r\n  let data = \"data:image\" + url;\r\n  imgDom.attr(\"src\", data);\r\n};\r\n\r\nfunction displayFullyImage(src) {\r\n  let $viewImageModal = $(\"#cantoViewBody\").find(\"#viewImageModal\");\r\n  let $pageMask = $(\"#cantoViewBody\").find(\"#pageMask\");\r\n  $viewImageModal.find(\"img\").attr(\"src\", src);\r\n  $(\"#cantoViewBody\").find(\".loading-icon\").addClass(\"hidden\");\r\n  $viewImageModal.removeClass(\"hidden\");\r\n  $pageMask.removeClass(\"hidden\");\r\n  $(\"#cantoViewBody\").find('.view-image-modal .close-btn').off('click').on('click', function () {\r\n    $viewImageModal.addClass(\"hidden\");\r\n    $pageMask.addClass(\"hidden\");\r\n  });\r\n}\r\n\r\n\r\nfunction imageDetail(detailData) {\r\n  if (detailData) {\r\n    $(\"#cantoViewBody\").find(\"#imageDetailModal_name\").html(detailData.name);\r\n    $(\"#cantoViewBody\").find(\"#imageDetailModal_size\").html(detailData.size + \"KB\");\r\n    $(\"#cantoViewBody\").find(\"#imageDetailModal_created\").html(dateHandler(detailData.created));\r\n    $(\"#cantoViewBody\").find(\"#imageDetailModal_uploaded\").html(dateHandler(detailData.lastUploaded));\r\n    $(\"#cantoViewBody\").find(\"#imageDetailModal_status\").html(detailData.approvalStatus);\r\n    $(\"#cantoViewBody\").find(\"#insertIntoPostBtn\").data(\"downloadurl\", detailData.url.download);\r\n\r\n    let $imageDetailModal = $(\"#cantoViewBody\").find(\"#imageDetailModal\");\r\n    $(\"#cantoViewBody\").find(\".loading-icon\").addClass(\"hidden\");\r\n    $imageDetailModal.removeClass(\"hidden\");\r\n    $(\"#cantoViewBody\").find('#imageDetailModal .close-btn').off('click').on('click', function () {\r\n      $imageDetailModal.addClass(\"hidden\");\r\n    });\r\n  }\r\n}\r\n\r\nfunction imageNewDetail(detailData) {\r\n  let sliceString = function (string, dom, length) {\r\n    if (!string) {\r\n      $(dom).closest(\".detail-item\").addClass(\"hidden\");\r\n      return \"Null\";\r\n    } else {\r\n      $(dom).closest(\".detail-item\").removeClass(\"hidden\");\r\n    }\r\n    if (!length) {\r\n      length = 150;\r\n    }\r\n    if (string.length > length) {\r\n      $(dom).removeClass(\"hidden\");\r\n      return string.slice(0, length) + \"...\";\r\n    } else {\r\n      $(dom).addClass(\"hidden\");\r\n      return string;\r\n    }\r\n  };\r\n  if (detailData) {\r\n    $(\"#cantoViewBody\").find(\"#imagebox_name\").html(detailData.name);\r\n    $(\"#cantoViewBody\").find(\"#imagebox_size\").html(Math.round(detailData.size / 1024) + \"KB\");\r\n    $(\"#cantoViewBody\").find(\"#imagebox_created\").html(detailData.metadata ? (detailData.metadata[\"Create Date\"] ? detailData.metadata[\"Create Date\"] : \" \") : \" \");\r\n    $(\"#cantoViewBody\").find(\"#imagebox_uploaded\").html(dateHandler(detailData.lastUploaded));\r\n    $(\"#cantoViewBody\").find(\"#imagebox_status\").html(detailData.approvalStatus);\r\n    let copyrightMoreDom = $(\"#imagebox_copyright\").closest(\".detail-item\").find(\".more\");\r\n    $(\"#cantoViewBody\").find(\"#imagebox_copyright\").html(sliceString(detailData.copyright, copyrightMoreDom, 177));\r\n    $(\"#cantoViewBody\").find(\"#imagebox_copyright\").data(\"field\", detailData.copyright);\r\n    let tactMoreDom = $(\"#imagebox_tac\").closest(\".detail-item\").find(\".more\");\r\n    $(\"#cantoViewBody\").find(\"#imagebox_tac\").html(sliceString(detailData.termsAndConditions, tactMoreDom, 160));\r\n    $(\"#cantoViewBody\").find(\"#imagebox_tac\").data(\"field\", detailData.termsAndConditions);\r\n    $(\"#cantoViewBody\").find(\"#insertBtn\").data(\"id\", detailData.id);\r\n    $(\"#cantoViewBody\").find(\"#insertBtn\").data(\"scheme\", detailData.scheme);\r\n  }\r\n\r\n  let $imageDetailModal = $(\"#cantoViewBody\").find(\"#imagePreviewModal\");\r\n  $(\"#cantoViewBody\").find(\".loading-icon\").addClass(\"hidden\");\r\n  $imageDetailModal.removeClass(\"hidden\");\r\n  $(\"#cantoViewBody\").find('#imagePreviewModal .close-btn').off('click').on('click', function () {\r\n    $imageDetailModal.addClass(\"hidden\");\r\n  });\r\n  $(\"#cantoViewBody\").find('#imagePreviewModal #cancelBtn').off('click').on('click', function () {\r\n    $imageDetailModal.addClass(\"hidden\");\r\n  });\r\n  $(\"#cantoViewBody\").find('#imagePreviewModal .detail-item .more').off('click').on('click', function () {\r\n    let text = $(this).closest(\".detail-item\").find(\".content\").data(\"field\");\r\n    $(this).closest(\".detail-item\").find(\".content\").html(text);\r\n    $(this).addClass(\"hidden\");\r\n  });\r\n  $(\"#cantoViewBody\").find('#imagePreviewModal #insertBtn').off('click').on('click', function () {\r\n    $(\"#cantoViewBody\").find(\".loading-icon\").removeClass(\"hidden\");\r\n    let assetArray = [];\r\n    let obj = {};\r\n    obj.id = detailData.id;\r\n    obj.scheme = detailData.scheme;\r\n    obj.size = detailData.size;\r\n    assetArray.push(obj);\r\n    cantoAPI.insertImage(assetArray);\r\n  });\r\n}\r\n\r\nfunction dateHandler(str) {\r\n  return str.substr(0, 4) + '-' + str.substr(4, 2) + '-'\r\n    + str.substr(6, 2) + ' ' + str.substr(8, 2) + ':' + str.substr(10, 2);\r\n}\r\n\r\nfunction treeviewDataHandler() {\r\n  cantoAPI.loadTree(treeviewController);\r\n}\r\n\r\nlet treeviewController = function (dummyData) {\r\n  let html = \"\";\r\n  html = treeviewFirstRender(dummyData);\r\n  $(\"#cantoViewBody\").find(\"#treeviewContent\").append(html);\r\n  $(\"#cantoViewBody\").find(\"#treeviewContent > ul\").animate({\r\n    height: 'toggle'\r\n  });\r\n\r\n};\r\nlet treeviewFirstRender = function (data) {\r\n  let html = \"<ul style='display: none;'>\";\r\n  $.each(data, function (i, d) {\r\n    let listclass = \" \";\r\n    if (d.size == 0) {\r\n      listclass = \"no-child\";\r\n    } else if (d.scheme == \"folder\") {\r\n      listclass = \"has-sub-folder\";\r\n    }\r\n    html += `<li data-id=\"${d.id}\"  class=\"${listclass}\">`;\r\n    let iconStyle = \"icon-s-Folder_open-20px\";\r\n    if (d.scheme == \"album\") {\r\n      iconStyle = \"icon-s-Album-20px\";\r\n    }\r\n    html += `<i class=\"${iconStyle}\"></i>\r\n                    <img src=\"https://s3-us-west-2.amazonaws.com/static.dmc/universal/icon/cantoloading.gif\" class=\"folder-loading hidden\" alt=\"Loading\">\r\n                    <span>${d.name}</span>\r\n                </li>`;\r\n  });\r\n  html += \"</ul>\";\r\n  return html;\r\n};\r\nlet subTreeRender = function (data) {\r\n  let html = treeviewRender(data);\r\n  $(\"#cantoViewBody\").find(\".current-tree-node\").append(html);\r\n  $(\"#cantoViewBody\").find(\".current-tree-node > ul\").animate({\r\n    height: 'toggle'\r\n  });\r\n  $(\"#cantoViewBody\").find(\".current-tree-node\").find(\".folder-loading\").addClass(\"hidden\");\r\n  $(\"#cantoViewBody\").find(\".current-tree-node\").find(\".icon-s-Folder_open-20px\").removeClass(\"hidden\");\r\n  $(\"#cantoViewBody\").find(\".current-tree-node\").removeClass(\"current-tree-node\");\r\n};\r\nlet treeviewRender = function (data) {\r\n  let html = \"<ul style='display: none;'>\";\r\n  $.each(data, function (i, d) {\r\n    let listclass = \" \";\r\n    if (d.size == 0) {\r\n      listclass = \"no-child\";\r\n    }\r\n    html += `<li data-id=\"${d.id}\"  class=\"${listclass}\">`;\r\n    let iconStyle = \"icon-s-Folder_open-20px\";\r\n    if (d.scheme == \"album\") {\r\n      iconStyle = \"icon-s-Album-20px\";\r\n    }\r\n    html += `<i class=\"${iconStyle}\"></i>\r\n                    <span>${d.name}</span>`;\r\n    if (d.children && d.children.length) {\r\n      html += treeviewRender(d.children);\r\n    }\r\n    html += '</li>';\r\n  });\r\n  html += \"</ul>\";\r\n  return html;\r\n};\r\n\r\nfunction imageResize() {\r\n  let initCount = 8;\r\n  // let totalWidth = totalWidth = Number($(\"#cantoViewBody\").find(\"#imagesContent\")[0].offsetWidth);\r\n  let totalWidth = Number($(\"#cantoViewBody\").find(\"#imagesContent\")[0].offsetWidth);\r\n  let singleImageWidth = 0;\r\n  let getCountInALine = function (n) {\r\n    singleImageWidth = Number((totalWidth - 8) / n - 2);\r\n    if ((singleImageWidth >= 160) && (singleImageWidth <= 210)) {\r\n      return singleImageWidth;\r\n    } else if (singleImageWidth < 160) {\r\n      n--;\r\n      getCountInALine(n);\r\n    } else if (singleImageWidth > 210) {\r\n      n++;\r\n      getCountInALine(n);\r\n    }\r\n  };\r\n  let singleWidth = getCountInALine(initCount);\r\n  $(\"#cantoViewBody\").find('.single-image').css(\"width\", singleWidth);\r\n}\r\n\r\n//scroll to load more\r\n\r\nfunction isScrollToPageBottom() {\r\n  let bodyHeight = $(\"#cantoImageBody\").height();\r\n  let documentHeight = $(\"#imagesContent\").height();\r\n  let scrollHeight = $(\"#cantoImageBody\").scrollTop();\r\n  let isToBottom = documentHeight - bodyHeight - scrollHeight < 0;\r\n  let nowCount = $(\".single-image\").length == 0;\r\n  return isToBottom && !nowCount;\r\n}\r\n\r\nfunction loadMoreHandler() {\r\n  let start = currentImageList.length == 0 ? 0 : apiNextStart;\r\n  let filterString = \"sortBy=time&sortDirection=descending&limit=\" + singleCountLoad + \"&start=\" + start;\r\n  let imageCount = $(\".single-image\").length;\r\n  if (imageCount !== 0) {\r\n    $(\"#loadingMore\").fadeIn(\"slow\");\r\n  } else {\r\n    $(\"#cantoViewBody\").find(\"#imagesContent\").html(\"\");\r\n  }\r\n  return filterString;\r\n}\r\n\r\nfunction loadMoreAction() {\r\n  if (searchedBy == \"bySearch\") {\r\n    let value = $(\"#cantoViewBody\").find(\"#globalSearch input\").val();\r\n    if (!value) {\r\n      return;\r\n    }\r\n    let initSchme = $(\"#cantoViewBody\").find(\".type-font.current\").data(\"type\");\r\n    let data = {};\r\n    data.scheme = initSchme;\r\n    data.keywords = value;\r\n    cantoAPI.getFilterList(data, imageListDisplay);\r\n  } else if (searchedBy == \"bytree\") {\r\n    let albumId = $(\"#cantoViewBody\").find(\"#treeviewSection ul li\").find(\".selected\").data(\"id\");\r\n    cantoAPI.getListByAlbum(albumId, imageListDisplay);\r\n  } else {\r\n    let initSchme = $(\"#cantoViewBody\").find(\".type-font.current\").data(\"type\");\r\n    getImageInit(initSchme);\r\n  }\r\n}\r\n\r\nfunction uploadClick(e) {\r\n  document.querySelector(\"#uploadBtnInvisible\").click();\r\n}\r\n\r\nfunction uploadFileToCanto(e) {\r\n  let url = `https://${_tenants}/api/v1/upload/setting`;\r\n  fetch(url, {\r\n    method: \"GET\",\r\n    headers: {\r\n      \"Authorization\": `${_tokenType} ${_accessToken}`,\r\n      \"Content-Type\": \"application/json; charset=utf-8\"\r\n    },\r\n  }).then(response => {\r\n    return response.json();\r\n  }).then(data => {\r\n    const formData = new FormData();\r\n    formData.append(\"key\", data.key);\r\n    formData.append(\"acl\", data.acl);\r\n    formData.append(\"AWSAccessKeyId\", data.AWSAccessKeyId);\r\n    formData.append(\"Policy\", data.Policy);\r\n    formData.append(\"Signature\", data.Signature);\r\n    formData.append(\"x-amz-meta-file_name\", e.files[0].name);\r\n    formData.append(\"x-amz-meta-tag\", \"\");\r\n    formData.append(\"x-amz-meta-scheme\", \"\");\r\n    formData.append(\"x-amz-meta-id\", \"\");\r\n    formData.append(\"x-amz-meta-album_id\", \"\");\r\n    formData.append(\"file\", e.files[0]);\r\n    let statusBar = parent.document.querySelector(\"#modal-status-bar\");\r\n\r\n    fetch(data.url, {\r\n      method: \"post\",\r\n      body: formData,\r\n      mode: \"no-cors\",\r\n      redirect: 'follow'\r\n    }).then(response => {\r\n      statusBar.style.display = \"block\";\r\n      statusBar.innerHTML = \"Uploading image...\";\r\n\r\n    }).catch(error => {\r\n      console.log(error);\r\n    }).finally(() => {\r\n      statusBar.innerHTML = \"Uploading - This can take several minutes...\";\r\n      checkStatusInterval(e.files[0].name);\r\n    });\r\n  }).catch(error => {\r\n    console.log(\"An error occurred while attempting to grab upload settings!\");\r\n    console.log(error);\r\n  });\r\n\r\n  function checkStatusInterval(filename) {\r\n    let url = `https://${_tenants}/api/v1/upload/status?hours=1`;\r\n    let statusBar = parent.document.querySelector(\"#modal-status-bar\");\r\n    statusChecker = setInterval(() => {\r\n\r\n      fetch(url, {\r\n        method: \"get\",\r\n        headers: {\"Authorization\": _tokenType + \" \" + _accessToken},\r\n      }).then(response => {\r\n        return response.json();\r\n      }).then(body => {\r\n        if (body.results && body.results.length > 0) {\r\n          let results = body.results.filter(e => {\r\n            console.log(\"evaluating: \", e);\r\n            if (e.name == filename && e.status != \"Done\") {\r\n              console.log(\"match!!!\");\r\n              return e;\r\n            }\r\n          });\r\n          if (results.filter(e => e != undefined).length == 0) {\r\n            statusBar.innerHTML = \"Canto processing complete! Reloading\"\r\n            window.location.reload();\r\n          }\r\n        }\r\n      }).catch(error => {\r\n        console.log(\"an error occurred!\");\r\n        console.log(error)\r\n      });\r\n    }, 5000);\r\n  }\r\n\r\n}\r\n\r\nparent.document.querySelector(\"#modal-status-bar\").style.display = \"none\";\r\n"],"names":["_accessToken","_tokenType","_tenants","cantoAPI","_APIHeaders","searchedBy","currentImageList","singleCountLoad","apiNextStart","isLoadingComplete","_formatDistrict","setToken","tokenInfo","callback","url","request","data","treeID","albumID","filterString","loadMoreHandler","previewURL","ID","scheme","contentID","targetWindow","imageArray","response","resp","i","j","getFrameDom","addEventListener","getTokenInfo","event","treeviewDataHandler","initSchme","getImageInit","contentIframe","e","imageResize","imageListDisplay","handleSelectedMode","assetArray","selectedArray","obj","displayFullyImage","targetURL","targetID","id","imageNewDetail","childList","subTreeRender","albumId","value","isScrollToPageBottom","loadMoreAction","inputObj","imageListSection","imageList","formatArr","d","extension","html","disname","rem","nameTop","iMin","iMax","bodyHeight","selectedCount","src","$viewImageModal","$pageMask","detailData","sliceString","string","dom","length","dateHandler","copyrightMoreDom","tactMoreDom","$imageDetailModal","text","str","treeviewController","dummyData","treeviewFirstRender","listclass","iconStyle","treeviewRender","initCount","totalWidth","singleImageWidth","getCountInALine","n","singleWidth","documentHeight","scrollHeight","isToBottom","nowCount","start"],"mappings":"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"}