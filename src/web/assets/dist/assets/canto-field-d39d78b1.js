(function(t){let s={},i="canto.com",d="52ff8ed9d6874d48a3bef9621bc1af26",o,r;const n="CantoDamConnector",c={env:"canto.com"};function l(a,e){this.element=a,this.options=t.extend({},c,e),this._defaults=c,this._name=n,this.init()}l.prototype={init:function(){t(()=>{p(this.options),t("#fields-remove-dam-asset").click(a=>{t("#fields-rosas-clicker").html("Add a DAM Asset"),t("#fields-dam-asset-preview").hide(),t(`#fields-${this.options.id}cantoId`).val(null),t(`#fields-${this.options.id}cantoAssetData`).val([])}),window.onmessage=a=>{var e=a.data;if(e&&e.type=="getTokenInfo"){var g=document.getElementById("cantoUCFrame").contentWindow;s.formatDistrict=r,g.postMessage(s,"*")}else if(e&&e.type=="cantoLogout")s={},t(".canto-uc-iframe-close-btn").trigger("click");else if(e&&e.type=="cantoInsertImage")t(".canto-uc-iframe-close-btn").trigger("click"),callback(o,e.assetList);else if(e&&e.type=="closeModal"){if(t("#fields-dam-preview-image").remove(),t("#fields-rosas-clicker").html("Choose a Different DAM Asset"),e.cantoId!==0){let m=e.cantoAssetData[0];t("#fields-dam-asset-preview").prepend(`<img id="fields-dam-preview-image" style="max-height:200px; max-width:200px;" src=${m.directUri}>`)}t(`#fields-${this.options.id}cantoId`).val(e.cantoId),t(`#fields-${this.options.id}cantoAssetData`).val(JSON.stringify(e.cantoAssetData)),t("#fields-dam-asset-preview").show(),f.hide()}else e&&h(e)}})}},t.fn[n]=function(a){return this.each(function(){t.data(this,"plugin_"+n)||t.data(this,"plugin_"+n,new l(this,a))})};function p(a){i=a.env,r=a.extensions}function h(a){t.ajax({type:"POST",url:"https://oauth.canto.com/oauth/api/oauth2/universal2/token",dataType:"json",data:{app_id:d,grant_type:"authorization_code",redirect_uri:"http://localhost:8080",code:a,code_verifier:"1649285048042"},success:function(e){s=e,u(s)},error:function(){alert("Get token errorz")}})}function u(a){t.ajax({type:"GET",url:"https://oauth."+i+":443/oauth/api/oauth2/tenant/"+a.refreshToken,success:function(e){a.tenant=e,console.log("in test.js loading UC!"),t("#cantoUCFrame").attr("src","/admin/_canto-dam-assets/canto-embed.twig")},error:function(){alert("Get tenant error")}})}})(jQuery);if($("#fields-dam-asset-preview").attr("data-thumbnailurl")==null||$("#fields-dam-asset-preview").attr("data-thumbnailurl")=="none")$("#fields-dam-asset-preview").hide();else{let t=$("#fields-dam-asset-preview").attr("data-thumbnailurl");$("#fields-rosas-clicker").html("Choose a Different DAM Asset"),$("#fields-dam-asset-preview").prepend(`<img id="fields-dam-preview-image" style="max-height:200px; max-width:200px;" src=${t}>`)}function v(t,s,i,d){let o={accessToken:d},r="https://oauth.canto.com/oauth/api/oauth2/universal2/authorize?response_type=code&app_id=52ff8ed9d6874d48a3bef9621bc1af26&redirect_uri=http://localhost:8080&state=abcd&code_challenge=1649285048042&code_challenge_method=plain";console.log("Inside of script.js about to load UC!");var n="/admin/_canto-dam-assets/canto-embed.twig";o.accessToken?($("#cantoUCFrame").attr("data-element",s),$("#cantoUCFrame").attr("data-field",t),$("#cantoUCFrame").attr("data-type",i),$("#cantoUCFrame").attr("data-access",o.accessToken),$("#cantoUCFrame").attr("src",n)):($("#cantoUCFrame").attr("data-element",s),$("#cantoUCFrame").attr("data-field",t),$("#cantoUCFrame").attr("data-type",i),$("#cantoUCFrame").attr("src",r))}let y=$(`
                <div id="rosas-modal" class="modal"> <!-- modal body -->
                    <div id="modal-test" class="body" style="padding: 0;"> <!-- modal-content -->
                        <header class="header" style="padding: 48px 48px 24px; margin: -24px -24px 0px;">
                            <h2>Canto Assets</h2>
                        </header>
                        <iframe id="cantoUCFrame" class="canto-uc-subiframe" src=""></iframe>
                        <div id="modal-status-bar">Uploading Image...</div>
                    </div>
                </div>
                `),f=new Garnish.Modal(y,{autoShow:!1});$("#fields-rosas-clicker").click(function(t){f.show();let s=t.target.dataset.field,i=t.target.dataset.element,d=t.target.dataset.type,o=t.target.dataset.access;v(s,i,d,o)});
//# sourceMappingURL=canto-field-d39d78b1.js.map
